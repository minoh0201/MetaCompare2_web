<html>
    <head>
        {% include "includes.html" %}
        <!-- Some styles for visualization part -->
        <style type="text/css">
            body, html {
                font-family: sans-serif;
            }
            
            .vis-item.sequence{
                background-color: lightgray;
                border-width: 0;
            }

            .vis-item.arg{
                background-color: salmon;
            }

            .vis-item.mge{
                background-color: lightgreen;
            }

            .vis-item.pat{
                background-color: purple;
                color: white;
            }
        </style>
    </head>
    <body>
        {% include "nav.html" %}
            <!--Back Button-->
        <!-- <div>
            <a href="{% url 'display_scaffolds' pk=pk %}">
                <button class="btn btn-info" style="margin:1%">
                    <i class="fa fa-arrow-left" style="font-size:16px"></i> Back
                </button>
            </a>
        </div> -->
        <!--/Back Button-->

        <!--Visualization div-->
        <div>            
            <h2 style="padding-left: 1%;">{{ scaffold_id }}</h2>
            <div id="visualization" style="padding-left: 2%; padding-right: 2%;"></div>
            <div style="position: absolute; left: 3%;">Start: 1</div>
            <div style="position: absolute; right: 2%;">End: {{ length }}</div>
        </div>
        <!--/Visualization div-->
        <br>
        <br>
        <!-- Show all hits -->
        <div style="margin-left:2%; margin-right:2%; max-width: 100%;">
            <table class="table-fill" >
                <thead>
                    <tr>
                        <th class="text-center">Type</th>
                        <th class="text-center">Reference database ID</th>
                        <th class="text-center">Start</th>
                        <th class="text-center">End</th>
                        <th class="text-center">Sequence</th>
                    </tr>
                </thead>
                <tbody class="table-hover">
                    {% for hit in hits %}
                    <tr>
                        <td class="text-center">{{ hit.type }}</td>
                        <td class="text-center">{{ hit.id }}</td>
                        <td class="text-center">{{ hit.start }}</td>
                        <td class="text-center">{{ hit.end }}</td>
                        <td class="text-center"><a href="">{{ hit.sequence|truncatechars:40 }}</a></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>    
        <br>
        {% include "footer.html" %}
    </body>
    <!-- /Show all hits -->
    <script type="text/javascript">
        // DOM element where the Timeline will be attached
        var container = document.getElementById('visualization');

        // Create a DataSet (allows two way data-binding)
        totalLength = {{ length }};
        function getScaffoldId(){
            return 'scaffold_3';
        }
        // scaffoldId = getScaffoldId();
        var items = new vis.DataSet( {{ data_set|safe }} );
        // var items = new vis.DataSet([
        //     {id: 1, group:2, content: 'item 1', className: 'mge', start: 90, end: 95},
        //     {id: 2, group:2, content: 'item 2', className: 'mge', start: 10, end: 20},
        //     {id: 3, group:2, content: 'item 3', className: 'mge', start: 20, end: 30},
        //     {id: 4, group:1, content: 'item 4', className: 'arg', start: 30, end: 45},
        //     {id: 5, group:1, content: 'item 5', className: 'arg', start: 60, end: 70},
        //     {id: 6, group:3, content: 'item 6', className: 'pat', start: 90, end: 100},
        //     {id: 7, group:0, content: 'A', className: 'sequence', start: 0, end: 1},
        //     {id: 8, group:0, content: 'T', className: 'sequence', start: 1, end: 2},
        //     {id: 9, group:0, content: 'A', className: 'sequence', start: 2, end: 3},
        //     {id: 10, group:0, content: 'G', className: 'sequence', start: 3, end: 4},
        //     {id: 11, group:0, content: 'C', className: 'sequence', start: 4, end: 5},
        // ]);

        var groups = [
            {
                id: 0,
                content: 'Scaffold ID',
                subgroupStack: true,
                className: 'sequence'
            },
            {
                id: 1,
                content: 'ARGs',
                subgroupStack: false,
                className: 'arg'
            },
            {
                id: 2,
                content: 'MGEs',
                subgroupStack: false,
                className: 'mge'
            },
            {
                id:3,
                content: 'Pathogens',
                subgroupStack: false,
                className: 'pat'
            }
        ]
        // Configuration for the Timeline
        var options = {
            start: new Date(1),
            end: new Date(totalLength),
            min: new Date(1),
            max: new Date(totalLength),
            showMajorLabels:false,
            format: {
                minorLabels: function(date, scale, step) {
                    switch (scale) {
                    case 'millisecond':
                        return new Date(date).getTime() + "";
                    case 'second':
                        // var seconds = Math.round(new Date(date).getTime() / 1000);
                        // return seconds*60 + "";
                        return new Date(date).getTime() + ""
                    case 'minute':
                        // var minutes = Math.round(new Date(date).getTime() / 1000 * 60);
                        // return minutes*60*60 + "";
                        return new Date(date).getTime() + ""
                    case 'hour':
                        // var hour = Math.round(new Date(date).getTime() / 1000 * 60 * 60);
                        // return minutes*60*60 + "";
                        return new Date(date).getTime() + ""
                    }
                }
            },
        };

        // Create a Timeline
        var timeline = new vis.Timeline(container, items, groups, options);
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</html>        